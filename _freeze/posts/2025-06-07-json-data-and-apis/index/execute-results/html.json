{
  "hash": "f6ce41165fe165c91f9ebe64896cfae1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"JSON Data and API's\"\ndescription: \"Access and parse API-based JSON data in R.\"\nauthor:\n  - name: Matt Babb\ndate: 06-07-2025\ncategories: [Quarto, R, JSON] # self-defined categories\nimage: leaflet_route.jpg\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\neditor: source\nembed-resources: true\necho: true\nwarning: false\nerror: false\ncode-fold: true\ncode-tools: true\n---\n\n## Pass Times for U.S. State Captials\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidyjson)\nlibrary(lubridate)\n\nstates <- read_table(\n  \"https://people.sc.fsu.edu/~jburkardt/datasets/states/state_capitals_ll.txt\",\n  col_names = c(\"state\", \"lat\", \"long\")\n) |>\n  filter(state != \"US\")\n\nget_datetimes <- function(lat, long, wait = 0.1) {\n  Sys.sleep(wait)\n\n  tryCatch(\n    {\n      start_times <- httr::GET(\n        glue::glue(\n          \"https://api.g7vrd.co.uk/v1/satellite-passes/25544/{lat}/{long}.json\"\n        ),\n        httr::timeout(10)\n      )$content |>\n        rawToChar() |>\n        as.tbl_json() |>\n        enter_object(\"passes\") |>\n        gather_array() |>\n        spread_all() |>\n        mutate(start_dt = as_datetime(start)) |>\n        filter(!is.na(start_dt)) |>\n        arrange(start_dt) |>\n        pull(start_dt)\n\n      valid_pass <- \\(n)\n        if (length(start_times) >= n) start_times[n] else NA_POSIXct_\n\n      tibble(\n        pass1 = valid_pass(1),\n        pass2 = valid_pass(2),\n        pass3 = valid_pass(3),\n      )\n    },\n    error = function(e) {\n      warning(glue::glue(\n        \"Error processing API for ({lat},{long}): {e$message}\"\n      ))\n      tibble(\n        pass1 = NA_POSIXct_,\n        pass2 = NA_POSIXct_,\n        pass3 = NA_POSIXct_\n      )\n    }\n  )\n}\n\nresult <- bind_cols(states, map2_df(states$lat, states$long, get_datetimes)) |>\n  write_csv(\"space_data.csv\")\n```\n:::\n\n\n## Mapping the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries\nlibrary(readr)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(lutz)\nlibrary(purrr)\nlibrary(leaflet)\n\n# Read in your ISS pass data CSV\nspace_data <- read_csv(\"space_data.csv\")\n\n# Clean the data:\n#    - Remove rows where all passes are NA\n#    - Filter only valid U.S. longitudes (negative)\ncleaned_space <- space_data %>%\n  filter(!(is.na(pass1) & is.na(pass2) & is.na(pass3))) %>%\n  filter(long < 0)\n\n# Assign time zones based on latitude & longitude\ncleaned_space <- cleaned_space %>%\n  mutate(tz = tz_lookup_coords(lat, long, method = \"accurate\"))\n\n# Keep only rows with valid Olson time zones\ncleaned_space <- cleaned_space %>%\n  filter(tz %in% OlsonNames())\n\n# Convert UTC pass times to local time for each state (rowwise using map2)\ncleaned_space <- cleaned_space %>%\n  mutate(\n    pass1_local = as_datetime(unlist(map2(pass1, tz, ~ with_tz(.x, .y)))),\n    pass2_local = as_datetime(unlist(map2(pass2, tz, ~ with_tz(.x, .y)))),\n    pass3_local = as_datetime(unlist(map2(pass3, tz, ~ with_tz(.x, .y))))\n  )\n\n\nrocket_icon <- makeIcon(\n  iconUrl = \"rocket.svg\",\n  iconWidth = 30, # Adjust size as needed\n  iconHeight = 30\n)\n```\n:::\n\n\n\n## International Space Station Pass Times (Local Time Zones)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot\nm <- leaflet(cleaned_space) %>%\n  addTiles() %>%\n  addMarkers(\n    lng = ~long,\n    lat = ~lat,\n    icon = rocket_icon,\n\n    # Hover label shows next pass in local time\n    label = ~ paste0(\"Next pass: \", format(pass1_local, \"%Y-%m-%d %H:%M:%S\")),\n\n    # Clickable popup shows all 3 local pass times\n    popup = ~ paste0(\n      \"<b>\",\n      state,\n      \"</b><br/>\",\n      \"Pass 1: \",\n      format(pass1_local, \"%Y-%m-%d %H:%M:%S\"),\n      \"<br/>\",\n      \"Pass 2: \",\n      format(pass2_local, \"%Y-%m-%d %H:%M:%S\"),\n      \"<br/>\",\n      \"Pass 3: \",\n      format(pass3_local, \"%Y-%m-%d %H:%M:%S\")\n    )\n  )\nm\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-50b36ad0087a3f5703fa\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-50b36ad0087a3f5703fa\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org/copyright/\\\">OpenStreetMap<\\/a>,  <a href=\\\"https://opendatacommons.org/licenses/odbl/\\\">ODbL<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[[32.361538,33.448457,34.736009,38.555605,39.7391667,41.767,38.913,39.161921,30.4518,33.76,21.30895,43.613739,39.78325,39.790942,41.590939,39.04,38.197274,30.45809,44.323535,38.972945,42.2352,42.7335,44.95,32.32,38.572954,46.595805,40.809868,39.160949,43.220093,40.221741,35.667231,42.659829,35.771,48.813343,39.962245,35.482309,44.931109,40.269789,18.2208,41.82355,34,44.367966,36.165,30.266667,40.7547,44.26639,37.54,47.042418,38.349497,43.074722,41.145548],[-86.279118,-112.073844,-92.33112199999999,-121.468926,-104.984167,-72.67700000000001,-77.01300000000001,-75.52675499999999,-84.27276999999999,-84.39,-157.826182,-116.237651,-89.650373,-86.147685,-93.62086600000001,-95.69,-84.86311000000001,-91.14022900000001,-69.765261,-76.50115700000001,-71.0275,-84.5467,-93.09399999999999,-90.20699999999999,-92.189283,-112.027031,-96.67534499999999,-119.753877,-71.549127,-74.75613800000001,-105.964575,-73.781339,-78.63800000000001,-100.779004,-83.000647,-97.534994,-123.029159,-76.875613,-66.59010000000001,-71.422132,-81.035,-100.336378,-86.78400000000001,-97.75,-111.892622,-72.57194,-77.45999999999999,-122.893077,-81.63329400000001,-89.384444,-104.802042],{\"iconUrl\":{\"data\":\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBVcGxvYWRlZCB0bzogU1ZHIFJlcG8sIHd3dy5zdmdyZXBvLmNvbSwgR2VuZXJhdG9yOiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4NCjxzdmcgZmlsbD0iIzAwMDAwMCIgaGVpZ2h0PSI4MDBweCIgd2lkdGg9IjgwMHB4IiB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiANCgkgdmlld0JveD0iMCAwIDUxMiA1MTIiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGc+DQoJPGc+DQoJCTxwYXRoIGQ9Ik00MTQuMTE4LDM4Mi4xNzN2LTkyLjI5MWwtNzUuMjk0LTU2LjQ3MVYxMjAuNDcxQzMzOC44MjQsNDUuMTc2LDI1NiwwLDI1Niwwcy04Mi44MjQsNDUuMTc2LTgyLjgyNCwxMjAuNDcxdjExMi45NDENCgkJCWwtNzUuMjk0LDU2LjQ3MXY5Mi4yOTFMNTIuNzA2LDQyNy4zNXYzOS40NzRoMTIwLjQ3MVY1MTJoMTY1LjY0N3YtNDUuMTc2aDEyMC40NzFWNDI3LjM1TDQxNC4xMTgsMzgyLjE3M3ogTTE3My4xNzYsNDIxLjY0Nw0KCQkJaC01MC44NzlsMjAuNzYyLTIwLjc2MnYtODguNDE1bDMwLjExOC0yMi41ODhWNDIxLjY0N3ogTTI5My42NDcsNDY2LjgyNGgtNzUuMjk0VjEyMC40NzFjMC0xOC4yOTUsOS4wMDEtMzYuODI2LDI2Ljc1Mi01NS4wNzgNCgkJCWMzLjY1OS0zLjc2Myw3LjM2Mi03LjE1OSwxMC44OTUtMTAuMTU5YzMuNTMzLDMsNy4yMzYsNi4zOTYsMTAuODk1LDEwLjE1OWMxNy43NTEsMTguMjUxLDI2Ljc1MiwzNi43ODMsMjYuNzUyLDU1LjA3OFY0NjYuODI0eg0KCQkJIE0zMzguODI0LDQyMS42NDdWMjg5Ljg4MmwzMC4xMTgsMjIuNTg4djg4LjQxNWwyMC43NjIsMjAuNzYySDMzOC44MjR6Ii8+DQoJPC9nPg0KPC9nPg0KPC9zdmc+\",\"index\":0},\"iconWidth\":30,\"iconHeight\":30},null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},[\"<b>AL<\\/b><br/>Pass 1: 2025-06-08 21:40:46<br/>Pass 2: 2025-06-09 20:52:21<br/>Pass 3: 2025-06-10 13:31:31\",\"<b>AZ<\\/b><br/>Pass 1: 2025-06-08 23:13:02<br/>Pass 2: 2025-06-09 15:52:47<br/>Pass 3: 2025-06-09 22:24:37\",\"<b>AR<\\/b><br/>Pass 1: 2025-06-08 21:39:22<br/>Pass 2: 2025-06-09 14:19:22<br/>Pass 3: 2025-06-09 20:50:57\",\"<b>CA<\\/b><br/>Pass 1: 2025-06-08 23:10:33<br/>Pass 2: 2025-06-09 15:52:03<br/>Pass 3: 2025-06-09 22:22:08\",\"<b>CO<\\/b><br/>Pass 1: 2025-06-08 21:36:23<br/>Pass 2: 2025-06-09 15:54:53<br/>Pass 3: 2025-06-09 22:24:43\",\"<b>CT<\\/b><br/>Pass 1: 2025-06-08 20:04:39<br/>Pass 2: 2025-06-09 12:47:19<br/>Pass 3: 2025-06-09 14:23:59\",\"<b>DC<\\/b><br/>Pass 1: 2025-06-08 20:04:24<br/>Pass 2: 2025-06-09 12:46:09<br/>Pass 3: 2025-06-09 19:15:59\",\"<b>DE<\\/b><br/>Pass 1: 2025-06-08 20:04:34<br/>Pass 2: 2025-06-09 12:46:24<br/>Pass 3: 2025-06-09 19:16:09\",\"<b>FL<\\/b><br/>Pass 1: 2025-06-08 21:41:25<br/>Pass 2: 2025-06-09 12:43:20<br/>Pass 3: 2025-06-09 20:53:05\",\"<b>GA<\\/b><br/>Pass 1: 2025-06-08 21:40:50<br/>Pass 2: 2025-06-09 20:52:20<br/>Pass 3: 2025-06-10 13:32:05\",\"<b>HI<\\/b><br/>Pass 1: 2025-06-08 18:07:56<br/>Pass 2: 2025-06-09 17:19:26<br/>Pass 3: 2025-06-10 03:09:36\",\"<b>ID<\\/b><br/>Pass 1: 2025-06-08 21:33:56<br/>Pass 2: 2025-06-08 23:10:41<br/>Pass 3: 2025-06-09 15:53:51\",\"<b>IL<\\/b><br/>Pass 1: 2025-06-08 21:38:57<br/>Pass 2: 2025-06-09 14:20:37<br/>Pass 3: 2025-06-09 20:50:27\",\"<b>IN<\\/b><br/>Pass 1: 2025-06-08 21:39:32<br/>Pass 2: 2025-06-09 14:21:12<br/>Pass 3: 2025-06-09 20:51:02\",\"<b>IA<\\/b><br/>Pass 1: 2025-06-08 21:37:57<br/>Pass 2: 2025-06-09 14:20:27<br/>Pass 3: 2025-06-09 20:49:27\",\"<b>KS<\\/b><br/>Pass 1: 2025-06-08 21:38:03<br/>Pass 2: 2025-06-09 14:19:38<br/>Pass 3: 2025-06-09 20:49:33\",\"<b>KY<\\/b><br/>Pass 1: 2025-06-08 21:40:03<br/>Pass 2: 2025-06-09 14:21:13<br/>Pass 3: 2025-06-09 20:51:28\",\"<b>LA<\\/b><br/>Pass 1: 2025-06-08 21:40:24<br/>Pass 2: 2025-06-10 13:30:19<br/>Pass 3: NA\",\"<b>ME<\\/b><br/>Pass 1: 2025-06-08 18:27:59<br/>Pass 2: 2025-06-08 20:04:49<br/>Pass 3: 2025-06-09 12:48:14\",\"<b>MD<\\/b><br/>Pass 1: 2025-06-08 20:04:30<br/>Pass 2: 2025-06-09 12:46:15<br/>Pass 3: 2025-06-09 19:16:05\",\"<b>MA<\\/b><br/>Pass 1: 2025-06-08 20:04:50<br/>Pass 2: 2025-06-09 12:47:35<br/>Pass 3: 2025-06-09 14:24:20\",\"<b>MI<\\/b><br/>Pass 1: 2025-06-08 20:02:30<br/>Pass 2: 2025-06-09 14:21:55<br/>Pass 3: 2025-06-09 19:14:05\",\"<b>MN<\\/b><br/>Pass 1: 2025-06-08 20:00:46<br/>Pass 2: 2025-06-08 21:37:36<br/>Pass 3: 2025-06-09 15:57:41\",\"<b>MS<\\/b><br/>Pass 1: 2025-06-08 21:40:06<br/>Pass 2: 2025-06-09 14:19:26<br/>Pass 3: 2025-06-10 13:30:46\",\"<b>MO<\\/b><br/>Pass 1: 2025-06-08 21:38:42<br/>Pass 2: 2025-06-09 14:20:02<br/>Pass 3: 2025-06-09 20:50:12\",\"<b>MT<\\/b><br/>Pass 1: 2025-06-08 18:20:02<br/>Pass 2: 2025-06-08 19:57:17<br/>Pass 3: 2025-06-08 21:34:12\",\"<b>NE<\\/b><br/>Pass 1: 2025-06-08 21:37:32<br/>Pass 2: 2025-06-09 14:19:52<br/>Pass 3: 2025-06-09 20:49:07\",\"<b>NV<\\/b><br/>Pass 1: 2025-06-08 23:10:43<br/>Pass 2: 2025-06-09 15:52:23<br/>Pass 3: 2025-06-09 22:22:18\",\"<b>NH<\\/b><br/>Pass 1: 2025-06-08 18:27:53<br/>Pass 2: 2025-06-08 20:04:38<br/>Pass 3: 2025-06-09 12:47:48\",\"<b>NJ<\\/b><br/>Pass 1: 2025-06-08 20:04:34<br/>Pass 2: 2025-06-09 12:46:44<br/>Pass 3: 2025-06-09 14:23:29\",\"<b>NM<\\/b><br/>Pass 1: 2025-06-08 23:13:44<br/>Pass 2: 2025-06-09 22:25:09<br/>Pass 3: 2025-06-10 15:05:34\",\"<b>NY<\\/b><br/>Pass 1: 2025-06-08 20:04:20<br/>Pass 2: 2025-06-09 14:23:50<br/>Pass 3: 2025-06-09 19:15:50\",\"<b>NC<\\/b><br/>Pass 1: 2025-06-09 12:45:15<br/>Pass 2: 2025-06-09 20:53:00<br/>Pass 3: 2025-06-10 13:33:30\",\"<b>ND<\\/b><br/>Pass 1: 2025-06-08 18:22:06<br/>Pass 2: 2025-06-08 19:59:06<br/>Pass 3: 2025-06-08 21:35:51\",\"<b>OH<\\/b><br/>Pass 1: 2025-06-08 20:03:16<br/>Pass 2: 2025-06-09 14:21:46<br/>Pass 3: 2025-06-09 20:51:31\",\"<b>OK<\\/b><br/>Pass 1: 2025-06-08 21:38:21<br/>Pass 2: 2025-06-09 14:18:36<br/>Pass 3: 2025-06-10 13:30:21\",\"<b>OR<\\/b><br/>Pass 1: 2025-06-08 18:17:52<br/>Pass 2: 2025-06-08 21:32:32<br/>Pass 3: 2025-06-08 23:09:22\",\"<b>PA<\\/b><br/>Pass 1: 2025-06-08 20:04:12<br/>Pass 2: 2025-06-09 14:23:02<br/>Pass 3: 2025-06-09 19:15:47\",\"<b>PR<\\/b><br/>Pass 1: 2025-06-08 21:46:53<br/>Pass 2: 2025-06-09 11:06:58<br/>Pass 3: 2025-06-09 20:58:18\",\"<b>RI<\\/b><br/>Pass 1: 2025-06-08 20:04:53<br/>Pass 2: 2025-06-09 12:47:28<br/>Pass 3: 2025-06-09 14:24:13\",\"<b>SC<\\/b><br/>Pass 1: 2025-06-08 21:41:23<br/>Pass 2: 2025-06-09 12:44:33<br/>Pass 3: 2025-06-09 20:52:53\",\"<b>SD<\\/b><br/>Pass 1: 2025-06-08 19:59:39<br/>Pass 2: 2025-06-08 21:36:24<br/>Pass 3: 2025-06-09 15:56:19\",\"<b>TN<\\/b><br/>Pass 1: 2025-06-08 21:39:59<br/>Pass 2: 2025-06-09 14:20:34<br/>Pass 3: 2025-06-09 20:51:29\",\"<b>TX<\\/b><br/>Pass 1: 2025-06-09 14:17:40<br/>Pass 2: 2025-06-09 22:27:30<br/>Pass 3: 2025-06-10 13:29:10\",\"<b>UT<\\/b><br/>Pass 1: 2025-06-08 21:35:05<br/>Pass 2: 2025-06-08 23:11:50<br/>Pass 3: 2025-06-09 15:53:50\",\"<b>VT<\\/b><br/>Pass 1: 2025-06-08 18:27:30<br/>Pass 2: 2025-06-08 20:04:20<br/>Pass 3: 2025-06-09 14:24:10\",\"<b>VA<\\/b><br/>Pass 1: 2025-06-08 20:04:36<br/>Pass 2: 2025-06-09 12:45:46<br/>Pass 3: 2025-06-09 20:52:56\",\"<b>WA<\\/b><br/>Pass 1: 2025-06-08 18:18:06<br/>Pass 2: 2025-06-08 19:55:16<br/>Pass 3: 2025-06-08 21:32:21\",\"<b>WV<\\/b><br/>Pass 1: 2025-06-08 20:03:47<br/>Pass 2: 2025-06-09 14:21:52<br/>Pass 3: 2025-06-09 20:52:02\",\"<b>WI<\\/b><br/>Pass 1: 2025-06-08 20:01:42<br/>Pass 2: 2025-06-09 14:21:17<br/>Pass 3: 2025-06-09 19:13:12\",\"<b>WY<\\/b><br/>Pass 1: 2025-06-08 21:36:13<br/>Pass 2: 2025-06-09 15:55:08<br/>Pass 3: 2025-06-09 20:47:43\"],null,null,null,[\"Next pass: 2025-06-08 21:40:46\",\"Next pass: 2025-06-08 23:13:02\",\"Next pass: 2025-06-08 21:39:22\",\"Next pass: 2025-06-08 23:10:33\",\"Next pass: 2025-06-08 21:36:23\",\"Next pass: 2025-06-08 20:04:39\",\"Next pass: 2025-06-08 20:04:24\",\"Next pass: 2025-06-08 20:04:34\",\"Next pass: 2025-06-08 21:41:25\",\"Next pass: 2025-06-08 21:40:50\",\"Next pass: 2025-06-08 18:07:56\",\"Next pass: 2025-06-08 21:33:56\",\"Next pass: 2025-06-08 21:38:57\",\"Next pass: 2025-06-08 21:39:32\",\"Next pass: 2025-06-08 21:37:57\",\"Next pass: 2025-06-08 21:38:03\",\"Next pass: 2025-06-08 21:40:03\",\"Next pass: 2025-06-08 21:40:24\",\"Next pass: 2025-06-08 18:27:59\",\"Next pass: 2025-06-08 20:04:30\",\"Next pass: 2025-06-08 20:04:50\",\"Next pass: 2025-06-08 20:02:30\",\"Next pass: 2025-06-08 20:00:46\",\"Next pass: 2025-06-08 21:40:06\",\"Next pass: 2025-06-08 21:38:42\",\"Next pass: 2025-06-08 18:20:02\",\"Next pass: 2025-06-08 21:37:32\",\"Next pass: 2025-06-08 23:10:43\",\"Next pass: 2025-06-08 18:27:53\",\"Next pass: 2025-06-08 20:04:34\",\"Next pass: 2025-06-08 23:13:44\",\"Next pass: 2025-06-08 20:04:20\",\"Next pass: 2025-06-09 12:45:15\",\"Next pass: 2025-06-08 18:22:06\",\"Next pass: 2025-06-08 20:03:16\",\"Next pass: 2025-06-08 21:38:21\",\"Next pass: 2025-06-08 18:17:52\",\"Next pass: 2025-06-08 20:04:12\",\"Next pass: 2025-06-08 21:46:53\",\"Next pass: 2025-06-08 20:04:53\",\"Next pass: 2025-06-08 21:41:23\",\"Next pass: 2025-06-08 19:59:39\",\"Next pass: 2025-06-08 21:39:59\",\"Next pass: 2025-06-09 14:17:40\",\"Next pass: 2025-06-08 21:35:05\",\"Next pass: 2025-06-08 18:27:30\",\"Next pass: 2025-06-08 20:04:36\",\"Next pass: 2025-06-08 18:18:06\",\"Next pass: 2025-06-08 20:03:47\",\"Next pass: 2025-06-08 20:01:42\",\"Next pass: 2025-06-08 21:36:13\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[18.2208,48.813343],\"lng\":[-157.826182,-66.59010000000001]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## Drawing the Route of the ISS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(leaflet.extras2)\n\nordered_result <- result |>\n  filter(!is.na(pass1)) |>\n  arrange(pass1)\n\nm |>\n  addArrowhead(\n    data = ordered_result,\n    lat = ~lat,\n    lng = ~long,\n    color = \"red\",\n    options = arrowheadOptions(\n      frequency = \"200px\",\n      size = \"10px\",\n      color = \"purple\",\n      opacity = 1,\n      fill = TRUE\n    )\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-bc683434c80649269bb1\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bc683434c80649269bb1\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org/copyright/\\\">OpenStreetMap<\\/a>,  <a href=\\\"https://opendatacommons.org/licenses/odbl/\\\">ODbL<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[[32.361538,33.448457,34.736009,38.555605,39.7391667,41.767,38.913,39.161921,30.4518,33.76,21.30895,43.613739,39.78325,39.790942,41.590939,39.04,38.197274,30.45809,44.323535,38.972945,42.2352,42.7335,44.95,32.32,38.572954,46.595805,40.809868,39.160949,43.220093,40.221741,35.667231,42.659829,35.771,48.813343,39.962245,35.482309,44.931109,40.269789,18.2208,41.82355,34,44.367966,36.165,30.266667,40.7547,44.26639,37.54,47.042418,38.349497,43.074722,41.145548],[-86.279118,-112.073844,-92.33112199999999,-121.468926,-104.984167,-72.67700000000001,-77.01300000000001,-75.52675499999999,-84.27276999999999,-84.39,-157.826182,-116.237651,-89.650373,-86.147685,-93.62086600000001,-95.69,-84.86311000000001,-91.14022900000001,-69.765261,-76.50115700000001,-71.0275,-84.5467,-93.09399999999999,-90.20699999999999,-92.189283,-112.027031,-96.67534499999999,-119.753877,-71.549127,-74.75613800000001,-105.964575,-73.781339,-78.63800000000001,-100.779004,-83.000647,-97.534994,-123.029159,-76.875613,-66.59010000000001,-71.422132,-81.035,-100.336378,-86.78400000000001,-97.75,-111.892622,-72.57194,-77.45999999999999,-122.893077,-81.63329400000001,-89.384444,-104.802042],{\"iconUrl\":{\"data\":\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBVcGxvYWRlZCB0bzogU1ZHIFJlcG8sIHd3dy5zdmdyZXBvLmNvbSwgR2VuZXJhdG9yOiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4NCjxzdmcgZmlsbD0iIzAwMDAwMCIgaGVpZ2h0PSI4MDBweCIgd2lkdGg9IjgwMHB4IiB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiANCgkgdmlld0JveD0iMCAwIDUxMiA1MTIiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGc+DQoJPGc+DQoJCTxwYXRoIGQ9Ik00MTQuMTE4LDM4Mi4xNzN2LTkyLjI5MWwtNzUuMjk0LTU2LjQ3MVYxMjAuNDcxQzMzOC44MjQsNDUuMTc2LDI1NiwwLDI1Niwwcy04Mi44MjQsNDUuMTc2LTgyLjgyNCwxMjAuNDcxdjExMi45NDENCgkJCWwtNzUuMjk0LDU2LjQ3MXY5Mi4yOTFMNTIuNzA2LDQyNy4zNXYzOS40NzRoMTIwLjQ3MVY1MTJoMTY1LjY0N3YtNDUuMTc2aDEyMC40NzFWNDI3LjM1TDQxNC4xMTgsMzgyLjE3M3ogTTE3My4xNzYsNDIxLjY0Nw0KCQkJaC01MC44NzlsMjAuNzYyLTIwLjc2MnYtODguNDE1bDMwLjExOC0yMi41ODhWNDIxLjY0N3ogTTI5My42NDcsNDY2LjgyNGgtNzUuMjk0VjEyMC40NzFjMC0xOC4yOTUsOS4wMDEtMzYuODI2LDI2Ljc1Mi01NS4wNzgNCgkJCWMzLjY1OS0zLjc2Myw3LjM2Mi03LjE1OSwxMC44OTUtMTAuMTU5YzMuNTMzLDMsNy4yMzYsNi4zOTYsMTAuODk1LDEwLjE1OWMxNy43NTEsMTguMjUxLDI2Ljc1MiwzNi43ODMsMjYuNzUyLDU1LjA3OFY0NjYuODI0eg0KCQkJIE0zMzguODI0LDQyMS42NDdWMjg5Ljg4MmwzMC4xMTgsMjIuNTg4djg4LjQxNWwyMC43NjIsMjAuNzYySDMzOC44MjR6Ii8+DQoJPC9nPg0KPC9nPg0KPC9zdmc+\",\"index\":0},\"iconWidth\":30,\"iconHeight\":30},null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},[\"<b>AL<\\/b><br/>Pass 1: 2025-06-08 21:40:46<br/>Pass 2: 2025-06-09 20:52:21<br/>Pass 3: 2025-06-10 13:31:31\",\"<b>AZ<\\/b><br/>Pass 1: 2025-06-08 23:13:02<br/>Pass 2: 2025-06-09 15:52:47<br/>Pass 3: 2025-06-09 22:24:37\",\"<b>AR<\\/b><br/>Pass 1: 2025-06-08 21:39:22<br/>Pass 2: 2025-06-09 14:19:22<br/>Pass 3: 2025-06-09 20:50:57\",\"<b>CA<\\/b><br/>Pass 1: 2025-06-08 23:10:33<br/>Pass 2: 2025-06-09 15:52:03<br/>Pass 3: 2025-06-09 22:22:08\",\"<b>CO<\\/b><br/>Pass 1: 2025-06-08 21:36:23<br/>Pass 2: 2025-06-09 15:54:53<br/>Pass 3: 2025-06-09 22:24:43\",\"<b>CT<\\/b><br/>Pass 1: 2025-06-08 20:04:39<br/>Pass 2: 2025-06-09 12:47:19<br/>Pass 3: 2025-06-09 14:23:59\",\"<b>DC<\\/b><br/>Pass 1: 2025-06-08 20:04:24<br/>Pass 2: 2025-06-09 12:46:09<br/>Pass 3: 2025-06-09 19:15:59\",\"<b>DE<\\/b><br/>Pass 1: 2025-06-08 20:04:34<br/>Pass 2: 2025-06-09 12:46:24<br/>Pass 3: 2025-06-09 19:16:09\",\"<b>FL<\\/b><br/>Pass 1: 2025-06-08 21:41:25<br/>Pass 2: 2025-06-09 12:43:20<br/>Pass 3: 2025-06-09 20:53:05\",\"<b>GA<\\/b><br/>Pass 1: 2025-06-08 21:40:50<br/>Pass 2: 2025-06-09 20:52:20<br/>Pass 3: 2025-06-10 13:32:05\",\"<b>HI<\\/b><br/>Pass 1: 2025-06-08 18:07:56<br/>Pass 2: 2025-06-09 17:19:26<br/>Pass 3: 2025-06-10 03:09:36\",\"<b>ID<\\/b><br/>Pass 1: 2025-06-08 21:33:56<br/>Pass 2: 2025-06-08 23:10:41<br/>Pass 3: 2025-06-09 15:53:51\",\"<b>IL<\\/b><br/>Pass 1: 2025-06-08 21:38:57<br/>Pass 2: 2025-06-09 14:20:37<br/>Pass 3: 2025-06-09 20:50:27\",\"<b>IN<\\/b><br/>Pass 1: 2025-06-08 21:39:32<br/>Pass 2: 2025-06-09 14:21:12<br/>Pass 3: 2025-06-09 20:51:02\",\"<b>IA<\\/b><br/>Pass 1: 2025-06-08 21:37:57<br/>Pass 2: 2025-06-09 14:20:27<br/>Pass 3: 2025-06-09 20:49:27\",\"<b>KS<\\/b><br/>Pass 1: 2025-06-08 21:38:03<br/>Pass 2: 2025-06-09 14:19:38<br/>Pass 3: 2025-06-09 20:49:33\",\"<b>KY<\\/b><br/>Pass 1: 2025-06-08 21:40:03<br/>Pass 2: 2025-06-09 14:21:13<br/>Pass 3: 2025-06-09 20:51:28\",\"<b>LA<\\/b><br/>Pass 1: 2025-06-08 21:40:24<br/>Pass 2: 2025-06-10 13:30:19<br/>Pass 3: NA\",\"<b>ME<\\/b><br/>Pass 1: 2025-06-08 18:27:59<br/>Pass 2: 2025-06-08 20:04:49<br/>Pass 3: 2025-06-09 12:48:14\",\"<b>MD<\\/b><br/>Pass 1: 2025-06-08 20:04:30<br/>Pass 2: 2025-06-09 12:46:15<br/>Pass 3: 2025-06-09 19:16:05\",\"<b>MA<\\/b><br/>Pass 1: 2025-06-08 20:04:50<br/>Pass 2: 2025-06-09 12:47:35<br/>Pass 3: 2025-06-09 14:24:20\",\"<b>MI<\\/b><br/>Pass 1: 2025-06-08 20:02:30<br/>Pass 2: 2025-06-09 14:21:55<br/>Pass 3: 2025-06-09 19:14:05\",\"<b>MN<\\/b><br/>Pass 1: 2025-06-08 20:00:46<br/>Pass 2: 2025-06-08 21:37:36<br/>Pass 3: 2025-06-09 15:57:41\",\"<b>MS<\\/b><br/>Pass 1: 2025-06-08 21:40:06<br/>Pass 2: 2025-06-09 14:19:26<br/>Pass 3: 2025-06-10 13:30:46\",\"<b>MO<\\/b><br/>Pass 1: 2025-06-08 21:38:42<br/>Pass 2: 2025-06-09 14:20:02<br/>Pass 3: 2025-06-09 20:50:12\",\"<b>MT<\\/b><br/>Pass 1: 2025-06-08 18:20:02<br/>Pass 2: 2025-06-08 19:57:17<br/>Pass 3: 2025-06-08 21:34:12\",\"<b>NE<\\/b><br/>Pass 1: 2025-06-08 21:37:32<br/>Pass 2: 2025-06-09 14:19:52<br/>Pass 3: 2025-06-09 20:49:07\",\"<b>NV<\\/b><br/>Pass 1: 2025-06-08 23:10:43<br/>Pass 2: 2025-06-09 15:52:23<br/>Pass 3: 2025-06-09 22:22:18\",\"<b>NH<\\/b><br/>Pass 1: 2025-06-08 18:27:53<br/>Pass 2: 2025-06-08 20:04:38<br/>Pass 3: 2025-06-09 12:47:48\",\"<b>NJ<\\/b><br/>Pass 1: 2025-06-08 20:04:34<br/>Pass 2: 2025-06-09 12:46:44<br/>Pass 3: 2025-06-09 14:23:29\",\"<b>NM<\\/b><br/>Pass 1: 2025-06-08 23:13:44<br/>Pass 2: 2025-06-09 22:25:09<br/>Pass 3: 2025-06-10 15:05:34\",\"<b>NY<\\/b><br/>Pass 1: 2025-06-08 20:04:20<br/>Pass 2: 2025-06-09 14:23:50<br/>Pass 3: 2025-06-09 19:15:50\",\"<b>NC<\\/b><br/>Pass 1: 2025-06-09 12:45:15<br/>Pass 2: 2025-06-09 20:53:00<br/>Pass 3: 2025-06-10 13:33:30\",\"<b>ND<\\/b><br/>Pass 1: 2025-06-08 18:22:06<br/>Pass 2: 2025-06-08 19:59:06<br/>Pass 3: 2025-06-08 21:35:51\",\"<b>OH<\\/b><br/>Pass 1: 2025-06-08 20:03:16<br/>Pass 2: 2025-06-09 14:21:46<br/>Pass 3: 2025-06-09 20:51:31\",\"<b>OK<\\/b><br/>Pass 1: 2025-06-08 21:38:21<br/>Pass 2: 2025-06-09 14:18:36<br/>Pass 3: 2025-06-10 13:30:21\",\"<b>OR<\\/b><br/>Pass 1: 2025-06-08 18:17:52<br/>Pass 2: 2025-06-08 21:32:32<br/>Pass 3: 2025-06-08 23:09:22\",\"<b>PA<\\/b><br/>Pass 1: 2025-06-08 20:04:12<br/>Pass 2: 2025-06-09 14:23:02<br/>Pass 3: 2025-06-09 19:15:47\",\"<b>PR<\\/b><br/>Pass 1: 2025-06-08 21:46:53<br/>Pass 2: 2025-06-09 11:06:58<br/>Pass 3: 2025-06-09 20:58:18\",\"<b>RI<\\/b><br/>Pass 1: 2025-06-08 20:04:53<br/>Pass 2: 2025-06-09 12:47:28<br/>Pass 3: 2025-06-09 14:24:13\",\"<b>SC<\\/b><br/>Pass 1: 2025-06-08 21:41:23<br/>Pass 2: 2025-06-09 12:44:33<br/>Pass 3: 2025-06-09 20:52:53\",\"<b>SD<\\/b><br/>Pass 1: 2025-06-08 19:59:39<br/>Pass 2: 2025-06-08 21:36:24<br/>Pass 3: 2025-06-09 15:56:19\",\"<b>TN<\\/b><br/>Pass 1: 2025-06-08 21:39:59<br/>Pass 2: 2025-06-09 14:20:34<br/>Pass 3: 2025-06-09 20:51:29\",\"<b>TX<\\/b><br/>Pass 1: 2025-06-09 14:17:40<br/>Pass 2: 2025-06-09 22:27:30<br/>Pass 3: 2025-06-10 13:29:10\",\"<b>UT<\\/b><br/>Pass 1: 2025-06-08 21:35:05<br/>Pass 2: 2025-06-08 23:11:50<br/>Pass 3: 2025-06-09 15:53:50\",\"<b>VT<\\/b><br/>Pass 1: 2025-06-08 18:27:30<br/>Pass 2: 2025-06-08 20:04:20<br/>Pass 3: 2025-06-09 14:24:10\",\"<b>VA<\\/b><br/>Pass 1: 2025-06-08 20:04:36<br/>Pass 2: 2025-06-09 12:45:46<br/>Pass 3: 2025-06-09 20:52:56\",\"<b>WA<\\/b><br/>Pass 1: 2025-06-08 18:18:06<br/>Pass 2: 2025-06-08 19:55:16<br/>Pass 3: 2025-06-08 21:32:21\",\"<b>WV<\\/b><br/>Pass 1: 2025-06-08 20:03:47<br/>Pass 2: 2025-06-09 14:21:52<br/>Pass 3: 2025-06-09 20:52:02\",\"<b>WI<\\/b><br/>Pass 1: 2025-06-08 20:01:42<br/>Pass 2: 2025-06-09 14:21:17<br/>Pass 3: 2025-06-09 19:13:12\",\"<b>WY<\\/b><br/>Pass 1: 2025-06-08 21:36:13<br/>Pass 2: 2025-06-09 15:55:08<br/>Pass 3: 2025-06-09 20:47:43\"],null,null,null,[\"Next pass: 2025-06-08 21:40:46\",\"Next pass: 2025-06-08 23:13:02\",\"Next pass: 2025-06-08 21:39:22\",\"Next pass: 2025-06-08 23:10:33\",\"Next pass: 2025-06-08 21:36:23\",\"Next pass: 2025-06-08 20:04:39\",\"Next pass: 2025-06-08 20:04:24\",\"Next pass: 2025-06-08 20:04:34\",\"Next pass: 2025-06-08 21:41:25\",\"Next pass: 2025-06-08 21:40:50\",\"Next pass: 2025-06-08 18:07:56\",\"Next pass: 2025-06-08 21:33:56\",\"Next pass: 2025-06-08 21:38:57\",\"Next pass: 2025-06-08 21:39:32\",\"Next pass: 2025-06-08 21:37:57\",\"Next pass: 2025-06-08 21:38:03\",\"Next pass: 2025-06-08 21:40:03\",\"Next pass: 2025-06-08 21:40:24\",\"Next pass: 2025-06-08 18:27:59\",\"Next pass: 2025-06-08 20:04:30\",\"Next pass: 2025-06-08 20:04:50\",\"Next pass: 2025-06-08 20:02:30\",\"Next pass: 2025-06-08 20:00:46\",\"Next pass: 2025-06-08 21:40:06\",\"Next pass: 2025-06-08 21:38:42\",\"Next pass: 2025-06-08 18:20:02\",\"Next pass: 2025-06-08 21:37:32\",\"Next pass: 2025-06-08 23:10:43\",\"Next pass: 2025-06-08 18:27:53\",\"Next pass: 2025-06-08 20:04:34\",\"Next pass: 2025-06-08 23:13:44\",\"Next pass: 2025-06-08 20:04:20\",\"Next pass: 2025-06-09 12:45:15\",\"Next pass: 2025-06-08 18:22:06\",\"Next pass: 2025-06-08 20:03:16\",\"Next pass: 2025-06-08 21:38:21\",\"Next pass: 2025-06-08 18:17:52\",\"Next pass: 2025-06-08 20:04:12\",\"Next pass: 2025-06-08 21:46:53\",\"Next pass: 2025-06-08 20:04:53\",\"Next pass: 2025-06-08 21:41:23\",\"Next pass: 2025-06-08 19:59:39\",\"Next pass: 2025-06-08 21:39:59\",\"Next pass: 2025-06-09 14:17:40\",\"Next pass: 2025-06-08 21:35:05\",\"Next pass: 2025-06-08 18:27:30\",\"Next pass: 2025-06-08 20:04:36\",\"Next pass: 2025-06-08 18:18:06\",\"Next pass: 2025-06-08 20:03:47\",\"Next pass: 2025-06-08 20:01:42\",\"Next pass: 2025-06-08 21:36:13\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addArrowhead\",\"args\":[[[[{\"lng\":[-157.826182,-123.029159,-122.893077,-112.027031,-100.779004,-72.57194,-71.549127,-69.765261,-100.336378,-93.09399999999999,-89.384444,-84.5467,-83.000647,-81.63329400000001,-76.875613,-73.781339,-77.01300000000001,-76.50115700000001,-74.75613800000001,-75.52675499999999,-77.45999999999999,-72.67700000000001,-71.0275,-71.422132,-116.237651,-111.892622,-104.802042,-104.984167,-96.67534499999999,-93.62086600000001,-95.69,-97.534994,-92.189283,-89.650373,-92.33112199999999,-86.147685,-86.78400000000001,-84.86311000000001,-90.20699999999999,-91.14022900000001,-86.279118,-84.39,-81.035,-84.27276999999999,-66.59010000000001,-121.468926,-119.753877,-112.073844,-105.964575,-78.63800000000001,-97.75],\"lat\":[21.30895,44.931109,47.042418,46.595805,48.813343,44.26639,43.220093,44.323535,44.367966,44.95,43.074722,42.7335,39.962245,38.349497,40.269789,42.659829,38.913,38.972945,40.221741,39.161921,37.54,41.767,42.2352,41.82355,43.613739,40.7547,41.145548,39.7391667,40.809868,41.590939,39.04,35.482309,38.572954,39.78325,34.736009,39.790942,36.165,38.197274,32.32,30.45809,32.361538,33.76,34,30.4518,18.2208,38.555605,39.160949,33.448457,35.667231,35.771,30.266667]}]]],null,null,{\"stroke\":true,\"color\":\"red\",\"weight\":5,\"opacity\":0.5,\"fill\":false,\"fillColor\":\"red\",\"fillOpacity\":0.2,\"smoothFactor\":1,\"noClip\":false,\"yawn\":60,\"size\":\"10px\",\"frequency\":\"200px\",\"proportionalToTotal\":false,\"color.1\":\"purple\",\"opacity.1\":1,\"fill.1\":true},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null,{\"yawn\":60,\"size\":\"10px\",\"frequency\":\"200px\",\"proportionalToTotal\":false,\"color\":\"purple\",\"opacity\":1,\"fill\":true}]}],\"limits\":{\"lat\":[18.2208,48.813343],\"lng\":[-157.826182,-66.59010000000001]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-binding-2.2.2/leaflet.js\"></script>\n<script src=\"../../site_libs/lfx-arrowhead-1.0.0/leaflet.geometryutil.js\"></script>\n<script src=\"../../site_libs/lfx-arrowhead-1.0.0/leaflet-arrowheads.js\"></script>\n<script src=\"../../site_libs/lfx-arrowhead-1.0.0/leaflet-arrowheads-bindings.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}